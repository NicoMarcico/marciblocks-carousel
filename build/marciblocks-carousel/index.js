(()=>{"use strict";var e,o={383:(e,o,l)=>{const r=window.wp.i18n,s=window.wp.blocks,i=window.wp.blockEditor,a=window.wp.element,c=window.wp.components,t=window.ReactJSXRuntime;function n(e){const{imagesIds:o,onSelectImages:l}=e;return(0,t.jsx)(i.BlockControls,{children:(0,t.jsx)(c.ToolbarGroup,{children:o&&(0,t.jsx)(i.MediaUpload,{onSelect:l,allowedTypes:["image"],multiple:"add",value:o,render:({open:e})=>(0,t.jsx)(c.ToolbarItem,{children:({isDisabled:o})=>(0,t.jsx)(c.Button,{onClick:e,isDisabled:o,icon:"edit",label:(0,r.__)("Edit images","marciblocks-carousel")})})})})})}function u(e){const{imageFit:o,isCaption:l,isDescription:s,isRadius:a,radius:n,aspectRatio:u,highlightColor:d,backgroundColor:m,captionColor:p,descriptionColor:b,setAttributes:g}=e;return(0,t.jsxs)(i.InspectorControls,{children:[(0,t.jsxs)(c.PanelBody,{title:(0,r.__)("Image adjustment","marciblocks-carousel"),children:[(0,t.jsx)(c.SelectControl,{label:(0,r.__)("Type of adjustment","marciblocks-carousel"),value:o,options:[{label:(0,r.__)("None","marciblocks-carousel"),value:"none"},{label:(0,r.__)("Cover","marciblocks-carousel"),value:"cover"},{label:(0,r.__)("Contain","marciblocks-carousel"),value:"contain"},{label:(0,r.__)("Fill","marciblocks-carousel"),value:"fill"}],onChange:e=>g({imageFit:e})}),(0,t.jsx)(c.SelectControl,{label:(0,r.__)("Display ratio","marciblocks-carousel"),value:u,options:[{label:"21/9",value:"21/9"},{label:"16/9",value:"16/9"},{label:"4/3",value:"4/3"},{label:"1/1",value:"1/1"},{label:"9/16",value:"9/16"}],onChange:e=>g({aspectRatio:e})})]}),(0,t.jsxs)(c.PanelBody,{title:(0,r.__)("Border radius","marciblocks-carousel"),children:[(0,t.jsx)(c.ToggleControl,{label:(0,r.__)("Radius","marciblocks-carousel"),checked:a,onChange:()=>g({isRadius:!a})}),a&&(0,t.jsx)(c.RangeControl,{value:n,onChange:e=>g({radius:e}),min:0,max:30,beforeIcon:"arrow-down",afterIcon:"arrow-up"})]}),(0,t.jsxs)(c.PanelBody,{title:(0,r.__)("Texts","marciblocks-carousel"),children:[(0,t.jsx)(c.ToggleControl,{label:(0,r.__)("Caption","marciblocks-carousel"),checked:l,onChange:()=>g({isCaption:!l})}),(0,t.jsx)(c.ToggleControl,{label:(0,r.__)("Description","marciblocks-carousel"),checked:s,onChange:()=>g({isDescription:!s})})]}),(0,t.jsx)(i.PanelColorSettings,{title:(0,r.__)("Colors","marciblocks-carousel"),colorSettings:[{value:d,onChange:e=>g({highlightColor:e}),label:(0,r.__)("Highlight color","marciblocks-carousel")},{value:m,onChange:e=>g({backgroundColor:e}),label:(0,r.__)("Background color","marciblocks-carousel")},l&&{value:p,onChange:e=>g({captionColor:e}),label:(0,r.__)("Caption color","marciblocks-carousel")},s&&{value:b,onChange:e=>g({descriptionColor:e}),label:(0,r.__)("Description color","marciblocks-carousel")}]})]})}const d=window.wp.data,m=window.React,p=window.wp.apiFetch;var b=l.n(p);function g(e){const{imagesIds:o,images:l,imageFit:s,isCaption:n,isDescription:u,carouselNumber:p,isRadius:g,radius:h,aspectRatio:k,highlightColor:_,backgroundColor:C,captionColor:v,descriptionColor:x,setAttributes:j,onSelectImages:w,isSelected:f,clientId:I,blockProps:S}=e,{childrenSelectedStates:B,innerBlocks:y,carouselIndex:N}=(0,d.useSelect)((e=>{if(!I)return;const o=e(i.store);return{childrenSelectedStates:o.getClientIdsOfDescendants(I).map((e=>o.isBlockSelected(e))),innerBlocks:o.getBlock(I).innerBlocks,carouselIndex:o.getBlocks().filter((e=>"marciblocks/carousel"===e.name)).findIndex((e=>e.clientId===I))}}),[I]);function R(e){let o=(new DOMParser).parseFromString(e,"text/html").body.textContent||"";return o=o.trim().replace(/\n/g,""),o}return(0,m.useEffect)((()=>{j({carouselNumber:N+1})}),[N]),(0,m.useEffect)((()=>{(f||B.includes(!0))&&j({imagesIds:y.map((e=>e.attributes.pictureId))}),(async()=>{if(f||B.includes(!0))try{const e=y.map((async e=>{var o,l,r,s,i,a,c,t,n;if(!e.attributes?.pictureId)return null;const u=await b()({path:`/wp/v2/media/${e.attributes.pictureId}`});return{id:u.id,title:u.title.rendered,alt:null!==(o=u.alt_text)&&void 0!==o?o:"",caption:null!==(l=R(u.caption?.rendered))&&void 0!==l?l:"",description:null!==(r=R(u.description?.rendered))&&void 0!==r?r:"",urlFull:null!==(s=null!==(i=u.media_details.sizes.full?.source_url)&&void 0!==i?i:u.source_url)&&void 0!==s?s:"",urlLarge:null!==(a=null!==(c=u.media_details.sizes.large?.source_url)&&void 0!==c?c:u.source_url)&&void 0!==a?a:"",urlMedium:null!==(t=null!==(n=u.media_details.sizes.medium?.source_url)&&void 0!==n?n:u.source_url)&&void 0!==t?t:""}})),o=(await Promise.all(e)).filter((e=>null!==e));j({images:o})}catch(e){console.error("Carousel getImages() error: ",e)}})()}),[y]),(0,t.jsx)("div",{...S,children:!o||(o.length?(0,t.jsx)(a.Fragment,{children:(0,t.jsxs)("div",{style:{"--carousel-custom-radius":g?h+"px":"none","--carousel-custom-ratio":k,"--carousel-custom-fit":s,"--carousel-custom-background-color":C,"--carousel-custom-highlight-color":_,"--carousel-custom-caption-color":v,"--carousel-custom-description-color":x},children:[(0,t.jsxs)("div",{className:"marciblocks-carousel-main",children:[(0,t.jsx)("div",{className:"marciblocks-carousel-items",children:(0,t.jsxs)("div",{className:"marciblocks-carousel-items__item",children:[(0,t.jsx)("img",{src:l.length>0&&l[0].urlLarge,alt:""}),n&&l[0].caption&&(0,t.jsx)("h3",{className:"marciblocks-carousel-items__item__caption",children:l[0].caption})]})}),(0,t.jsxs)("div",{className:"marciblocks-carousel-controls",children:[(0,t.jsx)("button",{className:"marciblocks-carousel-controls__control marciblocks-carousel-controls__control--prev",children:(0,t.jsx)("span",{className:"marciblocks-carousel-controls__control-arrow"})}),(0,t.jsx)("button",{className:"marciblocks-carousel-controls__control marciblocks-carousel-controls__control--next",children:(0,t.jsx)("span",{className:"marciblocks-carousel-controls__control-arrow"})})]})]}),u&&l[0].description&&(0,t.jsx)("div",{className:"marciblocks-carousel-descs",children:(0,t.jsx)("p",{className:"marciblocks-carousel-descs__desc",children:l[0].description})}),(0,t.jsx)(i.InnerBlocks,{renderAppender:!1,orientation:"horizontal"})]})}):(0,t.jsx)(i.MediaUploadCheck,{children:(0,t.jsx)(i.MediaUpload,{title:"Carousel d'images",allowedTypes:["image"],multiple:"add",value:o,onSelect:w,render:({open:e})=>(0,t.jsx)(c.Placeholder,{icon:"images-alt",label:(0,r.__)("Carousel","marciblocks-carousel"),instructions:(0,r.__)("Select images","marciblocks-carousel"),children:(0,t.jsx)(c.Button,{onClick:e,variant:"secondary",isLarge:!0,children:(0,r.__)("Select","marciblocks-carousel")})})})}))})}const h=JSON.parse('{"UU":"marciblocks/carousel"}');(0,s.registerBlockType)(h.UU,{title:(0,r.__)("Carousel","marciblocks-carousel"),description:(0,r.__)("Carousel of images with thumbnails.","marciblocks-carousel"),keywords:(0,r.__)("Carousel, Images, Gallery","marciblocks-carousel"),edit:function(e){const o=(0,i.useBlockProps)(),{attributes:l,setAttributes:r,isSelected:s,clientId:c}=e,{imagesIds:d,images:m,imageFit:p,isCaption:b,isDescription:h,isRadius:k,radius:_,aspectRatio:C,highlightColor:v,backgroundColor:x,captionColor:j,descriptionColor:w,carouselNumber:f}=l,I=e=>{if(!e||!e.length)return;const o=e.map((e=>{const o=e.sizes?.medium?.url||e.url;return wp.blocks.createBlock("marciblocks/carousel-item",{pictureUrl:o,pictureAlt:e.alt,pictureId:e.id})}));wp.data.dispatch("core/block-editor").replaceInnerBlocks(wp.data.select("core/block-editor").getSelectedBlockClientId(),o)};return(0,t.jsxs)(a.Fragment,{children:[(0,t.jsx)(n,{imagesIds:d,onSelectImages:I}),(0,t.jsx)(u,{imageFit:p,isCaption:b,isDescription:h,isRadius:k,radius:_,aspectRatio:C,highlightColor:v,backgroundColor:x,captionColor:j,descriptionColor:w,setAttributes:r}),(0,t.jsx)(g,{imagesIds:d,images:m,imageFit:p,isCaption:b,isRadius:k,radius:_,aspectRatio:C,highlightColor:v,backgroundColor:x,captionColor:j,descriptionColor:w,isDescription:h,carouselNumber:f,setAttributes:r,onSelectImages:I,isSelected:s,clientId:c,blockProps:o})]})},save:function(){const e=i.useBlockProps.save();return(0,t.jsx)("div",{...e,children:(0,t.jsx)(i.InnerBlocks.Content,{})})}})}},l={};function r(e){var s=l[e];if(void 0!==s)return s.exports;var i=l[e]={exports:{}};return o[e](i,i.exports,r),i.exports}r.m=o,e=[],r.O=(o,l,s,i)=>{if(!l){var a=1/0;for(u=0;u<e.length;u++){for(var[l,s,i]=e[u],c=!0,t=0;t<l.length;t++)(!1&i||a>=i)&&Object.keys(r.O).every((e=>r.O[e](l[t])))?l.splice(t--,1):(c=!1,i<a&&(a=i));if(c){e.splice(u--,1);var n=s();void 0!==n&&(o=n)}}return o}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[l,s,i]},r.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return r.d(o,{a:o}),o},r.d=(e,o)=>{for(var l in o)r.o(o,l)&&!r.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:o[l]})},r.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{var e={543:0,895:0};r.O.j=o=>0===e[o];var o=(o,l)=>{var s,i,[a,c,t]=l,n=0;if(a.some((o=>0!==e[o]))){for(s in c)r.o(c,s)&&(r.m[s]=c[s]);if(t)var u=t(r)}for(o&&o(l);n<a.length;n++)i=a[n],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(u)},l=globalThis.webpackChunkmarciblocks_carousel=globalThis.webpackChunkmarciblocks_carousel||[];l.forEach(o.bind(null,0)),l.push=o.bind(null,l.push.bind(l))})();var s=r.O(void 0,[895],(()=>r(383)));s=r.O(s)})();